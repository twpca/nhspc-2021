# 挑水果 (fruit)

## 問題描述

查布拉國的布拉河沿岸以盛產水果聞名，河川的沿岸生產各類不同的水果並廣受消費者喜好。
身為水果博士的 P 教授也看好此地的水果品質，決定在這裡批發銷售此地的水果。

根據 P 教授的調查，布拉河的沿岸從上游開始一共有 $`c`$ 個水果產地，緊接著下游的 $`c`$ 個都市。
為了方便我們將上游到下游的地點依序以產地$`1`$、產地$`2`$、$`\cdots`$、產地$`c`$、都市 $`1`$、都市 $`2`$、$`\cdots`$、都市 $`c`$ 標號。
每個產地生產一種水果，且任兩個產地的水果種類都不同，第 $`i`$ 個產地可以產出 $`n_i`$ 顆種類 $`i`$ 的水果。

\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=0.7]
    \node[draw] (a0) at (0, 0) {產地 $1$};
    \node[draw] (a1) at (3, 0) {產地 $2$};
    \node[draw] (a2) at (6, 0) {$\cdots$};
    \node[draw] (a3) at (9, 0) {產地 $c$};

    \node[draw] (b0) at (12, 0) {都市 $1$};
    \node[draw] (b1) at (15, 0) {都市 $2$};
    \node[draw] (b2) at (18, 0) {$\cdots$};
    \node[draw] (b3) at (21, 0) {都市 $c$};

    \node[draw] (c) at (24, 0) {出海口};

    \draw[->] (a0) -- (a1);
    \draw[->] (a1) -- (a2);
    \draw[->] (a2) -- (a3);
    \draw[->] (a3) -- (b0);
    \draw[->] (b0) -- (b1);
    \draw[->] (b1) -- (b2);
    \draw[->] (b2) -- (b3);
    \draw[->] (b3) -- (c);
  \end{tikzpicture}
  \caption{圖一：上游到下游沿岸所經產地、都市一覽}
\end{figure}

P 教授決定從最上游的產地 $`1`$ 開始由上游往下游每天至一個產地或都市交易。
更詳細地說，P 教授第 $`1`$ 天會在產地 $`1`$，第 $`2`$ 天在產地 $`2`$，$`\cdots`$，
第 $`c`$ 天在產地 $`c`$，第 $`c+1`$ 天在都市 $`1`$，$`\cdots`$，第 $`2c`$ 天會在都市 $`c`$ 交易。
P 教授在每個產地時會將當地生產的**所有**水果買進並積載在他的船上，
而在都市時則會決定是否將船上的水果出售給此地的盤商。
由於水果有不同熟度，太生的話賣不了好價格；所以 P 教授決定水果從進貨到販賣至少得經過 $`c`$ 天
（也就是水果種類 $`i`$ 只能等到航行到都市 $`i`$ 之後才能販賣）。
若教授選擇在都市 $`i`$ 販賣水果，他會將船上**前 $`i`$ 種類的所有水果**卸貨給當地盤商並請當地盤商代為銷售。
若到最下游仍積載在船上的水果則會被拋棄不賣。

因為布拉河各地的地形不同，各地積載水果的成本也不盡相同。
為了簡化問題，我們假設在到達第 $`i`$ 個都市時船上每顆積載的水果不限種類會花費 P 教授 $`p_i`$ 元的積載成本。
另外若要委託都市 $`i`$ 的盤商銷售水果的話他還得付給當地盤商每顆水果 $`s_i`$ 的代銷費用，
根據 P 教授先前對布拉河沿岸各地的消費狀況調查，他已得知在都市 $`i`$ 能賣出恰 $`r_{i,j}`$ 顆種類 $`j`$ 的水果。（$`i \ge j`$、$`r_{i,j} \le n_j`$）

為了決定水果的販售價格，P 教授希望能事先計算出最多賣出的水果數量。
給定 P 教授的預算 $`T`$，他希望你幫他決定在這個預算內，應該要請哪些盤商代銷售才能使銷售水果數量最多呢？

\newpage

以下為兩個 $`c=3`$ 的例子，例子一，若 P 教授決定在都市 $`1,2,3`$ 販售的話，總花費及販售量如下：

- 產地 $`1`$ 積載 $`n_1`$ 顆種類 $`1`$ 的水果
- 產地 $`2`$ 積載 $`n_2`$ 顆種類 $`2`$ 的水果
- 產地 $`3`$ 積載 $`n_3`$ 顆種類 $`3`$ 的水果
- 都市 $`1`$ 花費 $`(n_1 + n_2 + n_3) \times p_1`$ 的積載費、$`n_1 \times s_1`$ 的代售費，售出 $`r_{1, 1}`$ 顆種類 $`1`$ 的水果
- 都市 $`2`$ 花費 $`(n_2 + n_3) \times p_2`$ 的積載費、$`n_2 \times s_2`$ 的代售費，售出 $`r_{2, 2}`$ 顆種類 $`2`$ 的水果
- 都市 $`3`$ 花費 $`n_3 \times p_3`$ 的積載費、$`n_3 \times s_3`$ 的代售費，售出 $`r_{3, 3}`$ 顆種類 $`3`$ 的水果

總共銷售 $`r_{1,1} + r_{2,2} + r_{3,3}`$ 顆水果。

\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=0.7]
    \node[draw] (a0) at (0, 0) {產地 $1$};
    \node[draw] (a1) at (3, 0) {產地 $2$};
    \node[draw] (a2) at (6, 0) {產地 $3$};
    \node[draw] (b0) at (9, 0) {都市 $1$};
    \node[draw] (b1) at (12, 0) {都市 $2$};
    \node[draw] (b2) at (15, 0) {都市 $3$};

    \node[draw] (b00) at (9, -3) {盤商};
    \node[draw] (b01) at (9, -6) {消費者};

    \node[draw] (b10) at (12, -3) {盤商};
    \node[draw] (b11) at (12, -6) {消費者};

    \node[draw] (b20) at (15, -3) {盤商};
    \node[draw] (b21) at (15, -6) {消費者};

    \draw[->] (a0) -- (a1);
    \draw[->] (a1) -- (a2);
    \draw[->] (a2) -- (b0);
    \draw[->] (b0) -- (b1);
    \draw[->] (b1) -- (b2);

    \draw[->] (b0) -- (b00) node[midway, right] {$n_1$ 顆};
    \draw[->] (b00) -- (b01) node[midway, right] {$r_{1,1}$ 顆};
    \draw[->] (b1) -- (b10) node[midway, right] {$n_2$ 顆};
    \draw[->] (b10) -- (b11) node[midway, right] {$r_{2,2}$ 顆};
    \draw[->] (b2) -- (b20) node[midway, right] {$n_3$ 顆};
    \draw[->] (b20) -- (b21) node[midway, right] {$r_{3,3}$ 顆};
  \end{tikzpicture}
  \caption{例一：若決定在都市 $1,2,3$ 卸貨販售}
\end{figure}

但如果只決定在都市 $`2`$ 販售的話，總花費及販售量如下：

- 產地 $`1`$ 積載 $`n_1`$ 顆種類 $`1`$ 的水果
- 產地 $`2`$ 積載 $`n_2`$ 顆種類 $`2`$ 的水果
- 產地 $`3`$ 積載 $`n_3`$ 顆種類 $`3`$ 的水果
- 都市 $`1`$ 花費 $`(n_1 + n_2 + n_3) \times p_1`$ 的積載費
- 都市 $`2`$ 花費 $`(n_1 + n_2 + n_3) \times p_2`$ 的積載費、$`(n_1 + n_2) \times s_2`$ 的代售費，售出 $`r_{2,1}`$ 顆種類 $`1`$ 的水果及 $`r_{2, 2}`$ 顆種類 $`2`$ 的水果
- 都市 $`3`$ 花費 $`n_3 \times p_3`$ 的積載費，這些水果將被拋棄不賣

總共賣了 $`r_{2,1} + r_{2,2}`$ 顆水果。

\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=0.7]
    \node[draw] (a0) at (0, 0) {產地 $1$};
    \node[draw] (a1) at (3, 0) {產地 $2$};
    \node[draw] (a2) at (6, 0) {產地 $3$};
    \node[draw] (b0) at (9, 0) {都市 $1$};
    \node[draw] (b1) at (12, 0) {都市 $2$};
    \node[draw] (b2) at (15, 0) {都市 $3$};

    \node[draw] (b10) at (12, -3) {盤商};
    \node[draw] (b11) at (12, -6) {消費者};

    \draw[->] (a0) -- (a1);
    \draw[->] (a1) -- (a2);
    \draw[->] (a2) -- (b0);
    \draw[->] (b0) -- (b1);
    \draw[->] (b1) -- (b2);

    \draw[->] (b1) -- (b10) node[midway, right] {$n_1 + n_2$ 顆};
    \draw[->] (b10) -- (b11) node[midway, right] {$r_{2,1} + r_{2,2}$ 顆};
  \end{tikzpicture}
  \caption{例二：若決定在都市 $2$ 卸貨販售}
\end{figure}

## 輸入格式

\begin{format}
\f{
$c$ $T$
$p_1$ $p_2$ $\cdots$ $p_c$
$s_1$ $s_2$ $\cdots$ $s_c$
$n_1$ $n_2$ $\cdots$ $n_c$
$r_{1,1}$
$r_{2,1}$ $r_{2,2}$
$r_{3,1}$ $r_{3,2}$ $r_{3,3}$
$\vdots$
$r_{c,1}$ $r_{c,2}$ $\cdots$ $r_{c,c}$
}
\end{format}

* $`c`$ 為產地數量（同時也是都市數量及水果種類數量）
* $`T`$ 為教授花費上限
* $`p_i`$ 為都市 $`i`$ 每顆水果的積載費
* $`s_i`$ 為都市 $`i`$ 盤商代售每顆水果的費用
* $`n_i`$ 為產地 $`i`$ 的數量
* $`r_{i,j}`$ 為都市 $`i`$ 最多賣出水果 $`j`$ 的數量 （$`1 \le j \le i \le c`$）

## 輸出格式

\begin{format}
\f{
$\textrm{ans}$
}
\end{format}

* $`\textrm{ans}`$ 為一個整數，代表銷售最多的水果數量。若成本 $`T`$ 不夠支付任何銷售方案的費用，$`\textrm{ans}`$ 為 $`-1`$。

## 測資限制

* $`1 \leq c \leq 40`$
* $`1 \leq T \leq 10^7`$
* $`1 \leq p_i \leq 1000`$
* $`1 \leq s_i \leq 1000`$
* $`1 \leq n_i \leq 40`$
* $`0 \leq r_{i, j} \leq n_j`$（$`1 \le j \le i \le c`$）
* 上面所有變數皆為整數

## 範例測試


\newpage <!-- pdf bug -->

## 評分說明

本題共有三組子任務，條件限制如下所示。
每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。

|  子任務  |  分數  | 額外輸入限制 |
| :------: | :----: | ------------ |
| 1 | {{score.subtask1}} | $`c \le 20`$、 $`T \le 30000`$ |
| 2 | {{score.subtask2}} | $`T \le 30000`$ |
| 3 | {{score.subtask3}} | 無額外限制 |
