# 街頭藝人 (busker)

## 問題描述

阿甘是一位街頭藝人，他到各地旅行，沿途表演賺取生活花費。

此次阿甘旅行到妙世界國，妙世界國的地圖上有很多節點，每個節點可以細分成兩種：都市和村莊。
已知妙世界國有 $`n`$ 座都市，都市的節點編號分別為 $1, 2, \cdots, n$，
有 $`m`$ 條**單向**大道連接這些都市，
每條大道單向連接兩相異都市，並且在都市間會經過**恰** $k$ 座村莊。
第 $`j`$ 條大道沿途經過的村莊節點編號分別為 $(n + (j-1)k + 1), (n + (j-1)k + 2), \cdots, (n + jk)$。

阿甘正思索著要如何規劃一條演藝路線。
演藝路線必須從一個節點開始，沿著大道經過其他節點，
且沿途去過的節點不再經過，最後再回到一開始出發的節點。

另外，各地的物價有所不同，有時表演得到的小費足以應付他的開支，有時卻不夠，
已知編號 $`i`$ 的節點表演所獲取的總收支為 $`c_i`$ 元，
阿甘希望在這條演藝路線上，不能有入不敷出的情況發生，
也就是說如果一條演藝路線經過的節點依序是 $`\delta_1, \delta_2, \cdots, \delta_r`$ (其中 $`\delta_1=\delta_r`$)，
那對所有整數 $`y \in [1, r]`$ 要滿足 $`\sum_{x=1}^y c_{\delta_x} \geq 0`$。
阿甘把這種演藝路線叫做**入能敷出演藝路線**。

下圖的例子中有 $`m = 6`$、$`n = 5`$、$`k = 1`$。圖中的紅色圓圈代表都市節點，藍色方形代表村莊節點。圓圈與方形中的數字代表進入此節點後會得到的收支。節點右上角的數字則代表節點編號。

\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=1.5,square/.style={regular polygon,regular polygon sides=4}]
    \def \Nodes {
      1/2/2/5,
      2/4/0/-1,
      3/6/2/3,
      4/4/4/2,
      5/0/4/-5,
      6/3/1/0,
      7/5/1/-4,
      10/3/3/-3,
      8/5/3/-3,
      9/4/2/-1,
      11/1/3/3}
    \def \Edges {
      6/1,
      1/10,
      11/1,
      2/6,
      7/2,
      9/2,
      3/7,
      8/3,
      4/8,
      4/9,
      10/4,
      5/11}

    \foreach \id / \x / \y / \w in \Nodes {
      \def \shape{\directlua{
        if \id <= 5 then
          tex.sprint("circle")
        else
          tex.sprint("square")
        end
      }}
      \def \color{\directlua{
        if \id <= 5 then
          tex.sprint("red!50")
        else
          tex.sprint("blue!50")
        end
      }}
      \def \xb{\directlua{
        tex.sprint(\x + 0.5)
      }}
      \def \yb{\directlua{
        tex.sprint(\y + 0.5)
      }}
      \node[draw,\shape,fill=\color,minimum size=1cm] (\id) at (\x, \y) {\small \w};
      \node[text width=1cm] at (\xb, \yb) {\small \id};
    }
    \foreach \x / \y in \Edges {
      \path[draw,->,thick] (\x) -- (\y);
    }
  \end{tikzpicture}
  \caption{圖一}
\end{figure}

一條入能敷出演藝路線可以依序經過都市 $`1`$ (此時阿甘口袋有 $`5`$ 元)、
村莊 $`10`$ (口袋剩 $`5-3 = 2`$ 元)、都市 $`4`$ (口袋剩 $`2+2 = 4`$ 元)、
村莊 $`9`$ (口袋剩 $`4-1 = 3`$ 元)、都市 $`2`$ (口袋剩 $`3-1 = 2`$ 元)、
村莊 $`6`$ (口袋剩 $`2+0 = 2`$ 元)，而最後回到都市 $`1`$ (口袋剩 $`2+5 = 7`$ 元)，沿途都沒有入不敷出的狀況。

如果兩條演藝路線經過的的大道集合相同只是起點不同，我們說這兩條演藝路線**在同一個迴路上**。

若和前一個例子在同一個迴路上，從都市 $`4`$ 出發或是村莊 $`6`$ 出發，也是入能敷出演藝路線。
但從村莊 $`9`$ 出發第一站便入不敷出，不是入能敷出演藝路線。

由於妙世界國很龐大，手算過於耗時，阿甘拜託你幫忙輸出任何一條入能敷出演藝路線，
並計算在同一個迴路上有幾個都市和幾個村莊可以當作入能敷出演藝路線的起始節點。

## 輸入格式

\begin{format}
\f{
$n$ $m$ $k$
$c_1$
$c_2$
$\vdots$
$c_n$
$x_1$ $y_1$ $c_{n+1}$ $c_{n+2}$ $\cdots$ $c_{n+k}$
$x_2$ $y_2$ $c_{n+k+1}$ $c_{n+k+2}$ $\cdots$ $c_{n+2k}$
$\vdots$
$x_{m}$ $y_{m}$ $c_{n+(m-1)k+1}$ $c_{n+(m-1)k+2}$ $\cdots$ $c_{n+mk}$
}
\end{format}

* $`n`$ 代表都市數量。
* $`m`$ 代表單向大道數量。
* $`k`$ 代表每條單向大道上有幾個村莊。
* $`c_i`$ 代表在第 $`i`$ 個節點表演的收支。
* $`x_j`$ 代表第 $`j`$ 條單向大道的起點都市。
* $`y_j`$ 代表第 $`j`$ 條單向大道的終點都市。

## 輸出格式

請依照以下格式輸出一組入能敷出演藝路線。若存在多組入能敷出演藝路線，輸出任意一組即可：
\begin{format}
\f{
$r$
$\delta_1$ $\delta_2$ $\cdots$ $\delta_r$
$city$ $village$
}
\end{format}

* $`r`$ 代表入能敷出演藝路線走過的節點數量
* $`\delta_i`$ 代表入能敷出演藝路線的第 $`i`$ 站的節點編號
* 輸出必須滿足 $`\delta_1 = \delta_r`$
* $`city`$ 代表在同一個迴路上有幾個都市可以當入能敷出演藝路線的起始節點
* $`village`$ 代表在同一個迴路上有幾個村莊可以當入能敷出演藝路線的起始節點
* 輸出的數皆為整數

若不存在入能敷出演藝路線，則輸出唯一一行 $`0`$：
\begin{format}
\f{
$0$
}
\end{format}

## 測資限制

* $`1 \le n \le 2000`$
* $`1 \le m \le 8000`$
* $`1 \le k \le n`$
* $`-10^8 \le c_i \le 10^8`$
* 對所有整數 $j \in [1, m]$ 保證 $`x_j \neq y_j`$
* 對所有整數 $a, b \in [1, m]$ 保證若 $`a \neq b`$ 則 $`x_a \neq x_b`$ 或 $`y_a \neq y_b`$
* 輸入的數皆為整數

## 範例測試

## 評分說明

本題共有三組子任務，條件限制如下所示。
每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。

|  子任務  |  分數  | 額外輸入限制 |
| :------: | :----: | ------------ |
| 1 | {{score.subtask1}} | $`n \le 20`$ |
| 2 | {{score.subtask2}} | $`n \le 90`$ |
| 3 | {{score.subtask3}} | 無額外限制 |
